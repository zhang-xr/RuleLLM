rule Python_Malware_Dropper_Pastebin {
    meta:
        author = "RuleLLM"
        description = "Detects Python-based malware dropper using pastebin for payload delivery and execution"
        confidence = 90
        severity = 95
    strings:
        $pastebin_url = /https?:\/\/pastebin\.[a-z]{2,3}\/view\/raw\/[a-z0-9]{8}/ ascii wide
        $download_pattern = /requests\.get\([^\)]+\)\.text/ ascii wide
        $file_write = /with\s+open\([^\)]+,\s*['"]w['"]/ ascii wide
        $exec_pattern = /exec\(compile\([^,]+,\s*"[^"]+",\s*"exec"\)\)/ ascii wide
        $file_remove = /os\.remove\([^\)]+\)/ ascii wide
    condition:
        all of them
}