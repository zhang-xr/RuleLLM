rule Python_Exception_Hidden_Malware {
    meta:
        author = "RuleLLM"
        description = "Detects Python scripts using try-except blocks to hide malicious code execution"
        confidence = 80
        severity = 75
    strings:
        $try_block = "try:" wide
        $except_pass = "except: pass" wide
        $subprocess = "subprocess" wide
        $powershell = "powershell" wide
    condition:
        filesize < 10KB and
        $try_block and $except_pass and
        ($subprocess or $powershell)
}