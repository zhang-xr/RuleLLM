rule Python_Malware_DataExfiltration_OAST_Domains {
    meta:
        author = "RuleLLM"
        description = "Detects Python scripts sending system data to suspicious OAST-like domains."
        confidence = 90
        severity = 80
    strings:
        $url1 = "oast-cn.byted-dast.com"
        $url2 = "i18n.oast-row.byted-dast.com"
        $url3 = "oast.fun"
        $http_get = "urllib.request.urlopen"
        $hostname = "platform.node()"
        $username = "getpass.getuser()"
        $current_path = "os.getcwd()"
    condition:
        all of ($url*) and 
        ($http_get and ($hostname or $username or $current_path))
}