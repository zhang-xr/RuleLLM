rule Python_Malware_Subprocess_Pip_Installs {
    meta:
        author = "RuleLLM"
        description = "Detects malicious Python code installing multiple packages via subprocess and pip"
        confidence = 90
        severity = 80
    strings:
        $pip_install = "subprocess.run([\"pip\", \"install\"" ascii wide
        $suspicious_packages = /(gitpython|requests|sockets|pycryptodome|uuid|cryptography|pyfiglet|browser_cookie3|discord_webhook|prettytable|getmac|pyautogui|winregistry|robloxpy|Pillow|tqdm)/ ascii wide
    condition:
        all of them
}