rule Python_Install_Hook_Malware {
    meta:
        author = "RuleLLM"
        description = "Detects Python setup.py files with malicious post-install hooks"
        confidence = 90
        severity = 80
    strings:
        $install_hook = "class PostInstallCommand(install)"
        $subprocess_run = "subprocess.run"
        $chr_obfuscation = /chr\(\d+\)/
        $shell_exec = "bash"
        $curl_exec = "curl"
    condition:
        all of them
}