rule Malware_HTTP_File_Upload {
    meta:
        author = "RuleLLM"
        description = "Detects HTTP POST requests with file uploads"
        confidence = 80
        severity = 75

    strings:
        $post_request = "self.session.post("
        $files_param = "files="
        $document_key = "'document'"

    condition:
        all of ($post_request, $files_param, $document_key)
}