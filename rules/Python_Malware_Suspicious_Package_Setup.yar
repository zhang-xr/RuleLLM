rule Python_Malware_Suspicious_Package_Setup {
    meta:
        author = "RuleLLM"
        description = "Detects suspicious Python package setup with potentially malicious metadata"
        confidence = 80
        severity = 70
    strings:
        $setup_func = "setup(" ascii wide
        $suspicious_name = /name=['\"][a-z]{10,}['\"]/ ascii wide
        $empty_license = "license=''" ascii wide
        $github_url = /url=['\"]https:\/\/github\.com\/[^\/]+\/[^\/]+['\"]/ ascii wide
    condition:
        all of them
}