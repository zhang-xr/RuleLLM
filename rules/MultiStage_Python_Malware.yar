rule MultiStage_Python_Malware {
    meta:
        author = "RuleLLM"
        description = "Detects multi-stage Python malware with download and execution capabilities"
        confidence = 95
        severity = 95
    strings:
        $s1 = "requests.get(url)"
        $s2 = "tempfile.NamedTemporaryFile"
        $s3 = "subprocess.call"
        $s4 = "base64.b64decode"
        $s5 = "exec("
    condition:
        3 of them and filesize < 10KB
}