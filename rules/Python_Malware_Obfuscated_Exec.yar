rule Python_Malware_Obfuscated_Exec {
    meta:
        author = "RuleLLM"
        description = "Detects Python malware using exec() with obfuscated code"
        confidence = 90
        severity = 85
    strings:
        $exec_pattern = /exec\s*\(\s*\"\"\.join\s*\(\s*map\s*\(chr\s*,\s*\[[0-9,\s]+\]\)\)\)/
        $import_subprocess = "import subprocess"
        $import_os = "import os"
    condition:
        all of them
}