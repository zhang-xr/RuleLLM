rule Python_Malware_Base64_Urls {
    meta:
        author = "RuleLLM"
        description = "Detects base64-encoded URLs in Python code"
        confidence = 95
        severity = 85
    strings:
        $base64_import = "import base64"
        $base64_decode = "b64decode("
        $base64_url_pattern = /b64decode\(b'[A-Za-z0-9+\/]+={0,2}'\)/
        $http_pattern = /http:\/\/[^\s]+/
    condition:
        all of ($base64_import, $base64_decode) and 
        2 of ($base64_url_pattern, $http_pattern)
}