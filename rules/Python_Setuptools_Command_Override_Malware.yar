rule Python_Setuptools_Command_Override_Malware {
    meta:
        author = "RuleLLM"
        description = "Detects malicious overrides of setuptools commands"
        confidence = 90
        severity = 85
    strings:
        $install_override = "class CustomInstallCommand(install)"
        $develop_override = "class CustomDevelopCommand(develop)"
        $egg_info_override = "class CustomEggInfoCommand(egg_info)"
        $cmdclass = "cmdclass={"
    condition:
        3 of them
}