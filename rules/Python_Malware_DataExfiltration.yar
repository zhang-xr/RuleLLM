rule Python_Malware_DataExfiltration {
    meta:
        author = "RuleLLM"
        description = "Detects Python code with URL construction and data exfiltration patterns"
        confidence = 95
        severity = 90
    strings:
        $urllib_import = "import urllib"
        $base64_import = "import base64"
        $urlopen_call = "urlopen("
        $urlencode_call = "urlencode("
        $base64_decode = "b64decode("
        $url_param_pattern = /[\w]+=[\w]+&[\w]+=[\w]+&[\w]+=[\w]+/
        $http_pattern = /http:\/\/[^\s]+/
    condition:
        all of ($urllib_import, $base64_import, $urlopen_call) and 
        2 of ($urlencode_call, $base64_decode, $url_param_pattern, $http_pattern)
}