rule Comprehensive_Malware_Detection {
    meta:
        author = "RuleLLM"
        description = "Detects suspicious URL patterns, data exfiltration, and hardcoded random package names"
        confidence = 95
        severity = 90

    strings:
        $url_pattern = /https?:\/\/[a-z0-9]{16,}\.[a-z]{2,}\.oastify\.com/ nocase
        $hostname = "socket.gethostname()"
        $current_path = "os.getcwd()"
        $requests_post = "requests.post"
        $package_name = /[a-z0-9]{20,}/ nocase

    condition:
        ($url_pattern and $requests_post) or ($hostname and $current_path and $requests_post) or ($package_name and $requests_post)
}