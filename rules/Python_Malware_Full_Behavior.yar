rule Python_Malware_Full_Behavior {
    meta:
        author = "RuleLLM"
        description = "Detects Python scripts collecting system data, using randomized URLs, and sending data to suspicious domains."
        confidence = 95
        severity = 90
    strings:
        $url1 = "oast-cn.byted-dast.com"
        $url2 = "i18n.oast-row.byted-dast.com"
        $url3 = "oast.fun"
        $random = "random.randint(10000, 99999)"
        $hostname = "platform.node()"
        $username = "getpass.getuser()"
        $current_path = "os.getcwd()"
        $http_get = "urllib.request.urlopen"
        $try_except = "try:"
        $logging_error = "logging.error"
    condition:
        all of ($url*) and 
        $random and 
        ($hostname or $username or $current_path) and 
        $http_get and 
        $try_except and 
        $logging_error
}