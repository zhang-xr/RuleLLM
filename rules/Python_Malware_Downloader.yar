rule Python_Malware_Downloader {
    meta:
        author = "RuleLLM"
        description = "Detects Python-based malware that downloads and executes payloads"
        confidence = 90
        severity = 80
    strings:
        $s1 = "import requests" ascii wide
        $s2 = /https?:\/\/[a-f0-9\-]{36}\.[a-z0-9\.\-]+\/[A-Za-z0-9_]+\.exe/ ascii wide
        $s3 = "os.system(\"set __COMPACT_LAYER=RunAsInvoker | start" ascii wide
        $s4 = "class PostDevelopCommand(develop)" ascii wide
        $s5 = "class PostInstallCommand(install)" ascii wide
    condition:
        all of them
}