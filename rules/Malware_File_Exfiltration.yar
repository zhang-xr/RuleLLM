rule Malware_File_Exfiltration {
    meta:
        author = "RuleLLM"
        description = "Detects code enumerating and exfiltrating files from specific directories"
        confidence = 85
        severity = 80

    strings:
        $extensions = /\.(jpg|jpeg|png)/
        $os_listdir = "os.listdir("
        $open_file = "open("
        $rb_mode = "'rb'"
        $storage_path = "/storage/emulated/0/DCIM/"

    condition:
        all of ($os_listdir, $open_file, $rb_mode) and 
        any of ($extensions, $storage_path)
}