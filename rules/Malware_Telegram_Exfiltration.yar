rule Malware_Telegram_Exfiltration {
    meta:
        author = "RuleLLM"
        description = "Detects code attempting to exfiltrate files using Telegram API"
        confidence = 90
        severity = 85

    strings:
        $telegram_api = "https://api.telegram.org/bot"
        $send_document = "sendDocument"
        $chat_id = "chat_id"
        $session = "requests.session()"
        $storage_path = "/storage/emulated/0/DCIM/"

    condition:
        all of ($telegram_api, $send_document, $chat_id, $session) and 
        any of ($storage_path)
}