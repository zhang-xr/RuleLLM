rule Python_Malware_File_Download_Execution {
    meta:
        author = "RuleLLM"
        description = "Detects file download and execution patterns in Python code"
        confidence = 95
        severity = 90
    strings:
        $requests_get = "requests.get"
        $file_write = /open\(.*,\s*[\'\"][wba][^\"\']+[\'\"]\)/
        $subprocess_run = "subprocess.run"
        $python_exec = /python.*\.py/
    condition:
        $requests_get and $file_write and $subprocess_run and $python_exec
}