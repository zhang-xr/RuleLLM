rule Python_Malware_Package_Installation {
    meta:
        author = "RuleLLM"
        description = "Detects suspicious Python package installations via subprocess"
        confidence = 95
        severity = 90
    strings:
        $pip_install = "subprocess.run(['pip', 'install'"
        $suspicious_pkgs = /(pycryptodome|pypiwin32|pyautogui|winreg|robust|browser_cookie3|discord_webhook)/
    condition:
        $pip_install and $suspicious_pkgs
}