rule python_post_install_malware {
    meta:
        author = "RuleLLM"
        description = "Detects malicious post-install execution in Python packages"
        confidence = 85
        severity = 90

    strings:
        $post_install_class = "class PostInstallCommand" // Custom install class
        $install_override = "cmdclass = {'install': PostInstallCommand}" // Override install command
        $reverse_shell_call = "reverse_shell" // Function call for reverse shell

    condition:
        all of ($post_install_class, $install_override) and any of ($reverse_shell_call)
}