rule Python_Malware_Git_Clone_Execution {
    meta:
        author = "RuleLLM"
        description = "Detects malicious Python code cloning and executing from GitHub repositories"
        confidence = 95
        severity = 90
    strings:
        $git_clone = "git.Repo.clone_from" ascii wide
        $repo_exec = "subprocess.run([\"python\", " ascii wide
        $github_url = /https:\/\/github\.com\/[^\/]+\/[^\/]+\.git/ ascii wide
    condition:
        all of them
}