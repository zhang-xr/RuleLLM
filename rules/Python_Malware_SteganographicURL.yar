rule Python_Malware_SteganographicURL {
    meta:
        author = "RuleLLM"
        description = "Detects Python malware that generates URLs using XOR operations with hardcoded byte arrays"
        confidence = 85
        severity = 80
    strings:
        $byte_array1 = /VAR1 = bytes\(\s*\[.*\]\s*\)/
        $byte_array2 = /VAR2 = bytes\(\s*\[.*\]\s*\)/
        $byte_array3 = /VAR3 = bytes\(\s*\[.*\]\s*\)/
        $url_gen = /url = \{\s*"x86_64": url1,\s*"arm64": url2\s*\}.get\(platform.machine\(\)\)/
        $xor_url = /''.join\(chr\(b \^ k\) for b, k in zip\(.*\)\)/
    condition:
        all of ($byte_array1, $byte_array2, $byte_array3) and
        any of ($url_gen, $xor_url)
}