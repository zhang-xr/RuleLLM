rule Python_Setup_Malware {
    meta:
        author = "RuleLLM"
        description = "Detects malicious Python setup.py files with suspicious patterns"
        confidence = 80
        severity = 75
    strings:
        $setup = "from distutils.core import setup"
        $empty_desc = "description = ''"
        $empty_requires = "install_requires=[]"
        $exec = "exec("
    condition:
        $setup and $empty_desc and $empty_requires and $exec
}