rule Python_Malware_ConditionalExecution {
    meta:
        author = "RuleLLM"
        description = "Detects Python malware that conditionally executes payloads based on file patterns"
        confidence = 80
        severity = 75
    strings:
        $base_path = /BASE = Path\("\/Users\/Shared"\)/
        $path_glob = /for path in BASE.glob\("C\*\/\*r\*\/2\*\/\*"\):/
        $custom_run = "CustomRun(path_bytes)"
        $hash_check = /if first_n_bytes == VAR1:/
    condition:
        all of ($base_path, $path_glob) and
        any of ($custom_run, $hash_check)
}