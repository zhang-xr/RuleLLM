rule Python_Base64_Exec_Malware {
    meta:
        author = "RuleLLM"
        description = "Detects Python code using base64-encoded exec for malicious payload execution"
        confidence = "95"
        severity = "90"
    
    strings:
        $base64_exec = "__import__('builtins').exec(__import__('builtins').compile(__import__('base64').b64decode"
        $urlopen = "urlopen("
        $exec_pattern = /exec\([^\)]+\)/
        $base64_pattern = /b64decode\(["'][A-Za-z0-9+\/]+={0,2}["']\)/
    
    condition:
        all of them and 
        filesize < 10KB
}